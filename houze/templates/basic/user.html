{% extends 'base.html' %}

{% block title %} Home {% endblock %}

{% block content %}
<div class="p-col">
    <div class="left-pp-col">
        <div class="p-main">
            <div class="p-first">
                {% if user.profile.avatar.url != null %}
                <img src="{{user.profile.avatar.url}}" alt="" class="uspp">
                {% else %}
                <div class="uspp" style="background: linear-gradient({{user.profile.avatar_default}});">
                    <div class="usgrcn">
                        {{user.profile.name|slice:"0:1"}}
                    </div>
                </div>
                {% endif %}
                <div class="p-names-col">
                    <div class="p-name">{{user.profile.name}}</div>
                    <div class="p-usname">@{{user.username}}</div>
                </div>
            </div>
            <div class="p-sec">
                <div class="flex">
                    <div class="avgR coll0" title="Profile rating">
                        <div class="title">
                            {{user.profile.my_rating}}
                        </div>
                        <div class="p-stars">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" aria-hidden="true"
                                role="presentation" focusable="false">
                                <path fill-rule="evenodd"
                                    d="m15.1 1.58-4.13 8.88-9.86 1.27a1 1 0 0 0-.54 1.74l7.3 6.57-1.97 9.85a1 1 0 0 0 1.48 1.06l8.62-5 8.63 5a1 1 0 0 0 1.48-1.06l-1.97-9.85 7.3-6.57a1 1 0 0 0-.55-1.73l-9.86-1.28-4.12-8.88a1 1 0 0 0-1.82 0z">
                                </path>
                            </svg>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" aria-hidden="true"
                                role="presentation" focusable="false">
                                <path fill-rule="evenodd"
                                    d="m15.1 1.58-4.13 8.88-9.86 1.27a1 1 0 0 0-.54 1.74l7.3 6.57-1.97 9.85a1 1 0 0 0 1.48 1.06l8.62-5 8.63 5a1 1 0 0 0 1.48-1.06l-1.97-9.85 7.3-6.57a1 1 0 0 0-.55-1.73l-9.86-1.28-4.12-8.88a1 1 0 0 0-1.82 0z">
                                </path>
                            </svg>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" aria-hidden="true"
                                role="presentation" focusable="false">
                                <path fill-rule="evenodd"
                                    d="m15.1 1.58-4.13 8.88-9.86 1.27a1 1 0 0 0-.54 1.74l7.3 6.57-1.97 9.85a1 1 0 0 0 1.48 1.06l8.62-5 8.63 5a1 1 0 0 0 1.48-1.06l-1.97-9.85 7.3-6.57a1 1 0 0 0-.55-1.73l-9.86-1.28-4.12-8.88a1 1 0 0 0-1.82 0z">
                                </path>
                            </svg>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" aria-hidden="true"
                                role="presentation" focusable="false">
                                <path fill-rule="evenodd"
                                    d="m15.1 1.58-4.13 8.88-9.86 1.27a1 1 0 0 0-.54 1.74l7.3 6.57-1.97 9.85a1 1 0 0 0 1.48 1.06l8.62-5 8.63 5a1 1 0 0 0 1.48-1.06l-1.97-9.85 7.3-6.57a1 1 0 0 0-.55-1.73l-9.86-1.28-4.12-8.88a1 1 0 0 0-1.82 0z">
                                </path>
                            </svg>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" aria-hidden="true"
                                role="presentation" focusable="false">
                                <path fill-rule="evenodd"
                                    d="m15.1 1.58-4.13 8.88-9.86 1.27a1 1 0 0 0-.54 1.74l7.3 6.57-1.97 9.85a1 1 0 0 0 1.48 1.06l8.62-5 8.63 5a1 1 0 0 0 1.48-1.06l-1.97-9.85 7.3-6.57a1 1 0 0 0-.55-1.73l-9.86-1.28-4.12-8.88a1 1 0 0 0-1.82 0z">
                                </path>
                            </svg>
                        </div>
                    </div>
                    <div class="avgR coll0">
                        <div class="title">{{rating_count}}</div>
                        <div class="info">Reviews</div>
                    </div>
                    <div class="avgR coll0">
                        <div class="title">{{user.profile.created_at|date:"M d"}}</div>
                        <div class="info">Joined</div>
                    </div>
                </div>
            </div>
            {% if user == request.user %}
            <div class="p-last">
                <div class="btnsubstart">
                    <a href="{% url 'signout' %}" class="btn-white" onclick="return confirmReq()">Sign out</a>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    <div class="right-pp-col">
        <div class="user-roomscol">
            {% if user.profile.bio %}
            <div class="lbld">
                <div class="botmidt">About {{user.profile.first_name}}</div>
                <div class="prbio coll0">
                    {{user.profile.bio}}
                </div>
            </div>
            {% endif %}
            <div class="lbld">
                <div class="botmidt">{{user.profile.first_name}}'s comments</div>
                <div id="room-reviews-content">
                    {% for comment in comments %}
                    <div class="review">
                        <div class="revleft">
                            <a href="{% url 'user_profile' comment.author.username %}">
                                {% if comment.author.profile.avatar.url != null %}
                                <img src="{{comment.author.profile.avatar.url}}" alt="" class="pp">
                                {% else %}
                                <div class="pp"
                                    style="background: linear-gradient({{comment.author.profile.avatar_default}});">
                                    <div class="grcn">
                                        {{comment.author.profile.name|slice:"0:1"}}
                                    </div>
                                </div>
                                {% endif %}
                            </a>
                        </div>
                        <div class="n-d">
                            <div class="n-stayed">
                                <a href="{% url 'user_profile' comment.author.username %}"
                                    class="reviewer-name">{{comment.author.profile.name}}</a>
                                <div class="spr">•</div>
                                <div class="review-date">{{comment.get_date}}</div>
                            </div>
                            <!--  -->
                            <div class="review-text">{{comment.text}}</div>
                        </div>
                    </div>
                    {% empty %}
                    <div class="infotxt coll0">No comments yet...</div>
                    {% endfor %}
                </div>
            </div>
            <div class="lbld">
                <div class="botmidt">{{user.profile.first_name}}'s listings</div>
                <div class="p-rooms">
                    {% for room in rooms %}
                    <div class="p-room">
                        <div class="roomtools">
                            <button class="objdel"
                                onclick="location.href='@{{request.user.username}}/rooms/{{room.id}}/edit';">
                                <svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg"
                                    xmlns:xlink="http://www.w3.org/1999/xlink">
                                    <g id="Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <g id="write_24">
                                            <polygon id="Shape" points="0 0 24 0 24 24 0 24"></polygon>
                                            <path
                                                d="M14.1882588,6.27301517 L17.7278487,9.81260506 L9.10415743,18.4354891 C8.33089999,19.2086803 7.3795132,19.7800394 6.33365949,20.0993225 L3.43116121,20.9854108 C3.2548849,21.0392252 3.06835948,20.9399503 3.01454502,20.763674 C2.99515549,20.700161 2.99515549,20.6323075 3.01454502,20.5687946 L3.90054461,17.6665868 C4.21988422,16.620548 4.79138805,15.6690125 5.5647823,14.8956845 L14.1882588,6.27301517 Z M15.2489686,5.21240463 L17.017722,3.44381677 C17.6035158,2.85807317 18.5532282,2.85809351 19.1389969,3.4438622 L20.5573573,4.86204088 C21.1431438,5.44782732 21.1431438,6.39757479 20.5573573,6.98336123 C20.5573422,6.98337637 20.5573271,6.98339152 20.5573119,6.98340666 L18.7885585,8.75199452 L15.2489686,5.21240463 Z"
                                                id="Mask" fill="currentColor"></path>
                                        </g>
                                    </g>
                                </svg>
                            </button>
                            <form action="{% url 'room_delete' room.id %}" method="POST">
                                {% csrf_token %}
                                <button class="objdel" type="submit" onclick="return confirmReq()">&times;</button>
                            </form>
                        </div>
                        <a href="{% url 'room_detail_url' room.id %}">
                            <div class="room-img">
                                {% if room.first_photo != Null %}
                                <img src="{{room.first_photo}}" alt="">
                                {% else %}
                                no image
                                {% endif %}
                            </div>
                            <div class="room-info">
                                <div class="room-fl">
                                    <div class="ci-cy">
                                        {{ room.get_city_display }}, Uzbekistan
                                    </div>
                                    <div class="rating">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" aria-hidden="true" role="presentation"
                                            focusable="false" style="display: block; height: 12px; width: 12px; fill: currentcolor;">
                                            <path fill-rule="evenodd"
                                                d="m15.1 1.58-4.13 8.88-9.86 1.27a1 1 0 0 0-.54 1.74l7.3 6.57-1.97 9.85a1 1 0 0 0 1.48 1.06l8.62-5 8.63 5a1 1 0 0 0 1.48-1.06l-1.97-9.85 7.3-6.57a1 1 0 0 0-.55-1.73l-9.86-1.28-4.12-8.88a1 1 0 0 0-1.82 0z">
                                            </path>
                                        </svg>
                                        {{room.average_rating}}
                                    </div>
                                </div>
                                <div class="in-out">{{room.av_dates}}</div>
                                <div class="r-price">From UZS {{room.get_price}}/night</div>
                            </div>
                        </a>
                    </div>
                    {% empty %}
                    <div class="infotxt coll0">No rooms were shared yet...</div>
                    {% endfor %}
                </div>
            </div>
            <div class="lbld">
                <div class="botmidt">{{user.profile.first_name}}'s reviews</div>
                <div id="room-reviews-content">
                    {% for review in reviews %}
                    <div class="revren">
                        <a href="{% url 'room_detail_url' review.room.id %}" class="ren">
                            <div class="rente">{{review.room.title}}</div>
                            <img class="renimg" src="{{review.room.first_photo}}" alt="">
                        </a>
                        <div class="hr"></div>
                        <div class="rev">
                            <div class="revleft">
                                <a href="{% url 'user_profile' review.user.username %}">
                                    {% if review.user.profile.avatar.url != null %}
                                    <img src="{{review.user.profile.avatar.url}}" alt="" class="pp">
                                    {% else %}
                                    <div class="pp"
                                        style="background: linear-gradient({{review.user.profile.avatar_default}});">
                                        <div class="grcn">
                                            {{review.user.profile.name|slice:"0:1"}}
                                        </div>
                                    </div>
                                    {% endif %}
                                </a>
                            </div>
                            <div class="n-d">
                                <div class="n-stayed">
                                    <a href="{% url 'user_profile' review.user.username %}"
                                        class="reviewer-name">{{review.user.profile.name}}</a>
                                    <div class="spr">•</div>
                                    <div class="review-date">{{review.get_date}}</div>
                                </div>
                                <!--  -->
                                <div class="r-stars">
                                    {{review.user_ratings|safe}}
                                </div>
                                <div class="review-text">{{review.review_text}}</div>
                            </div>
                        </div>
                    </div>
                    {% empty %}
                    <div class="infotxt coll0">No reviews yet...</div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block footer %}
{% endblock %}