{% load static %}
<!DOCTYPE html>
<html lang="en" style="overflow: auto scroll;">

<head>
    <title>Uzrent / {% block title %}{% endblock %}</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" type="image/x-icon" href="../../media/important/uzrent.png">

    <link rel="stylesheet" href="{% static 'base.css' %}">
</head>

<body>
    {% if messages %}
    {% for message in messages %}
    <div id="toast-position">
        <div class="toast">
            <p>{{ message }}</p>
        </div>
    </div>
    {% endfor %}
    {% endif %}
    <div id="signinModal" class="modal">
        <div class="modal-content">
            <div class="container">
                <div class="modal-title">
                    Sign in
                    <span onclick="closeSigninModal()" class="close">&times;</span>
                </div>
                {% include 'temps/signin_temp.html' %}
            </div>
        </div>
    </div>
    <div id="signupModal" class="modal">
        <div class="modal-content">
            <div class="container">
                <div class="modal-title">
                    Sign up
                    <span onclick="closeSignupModal()" class="close">&times;</span>
                </div>
                {% include 'temps/signup_temp.html' %}
            </div>
        </div>
    </div>
    <nav id="navbar">
        <div id="row">
            <ul class="row-content">
                <li class="row-con-itm">
                    <a href="{% url 'home' %}">
                        Uzrent
                        <!-- <img class="logo-img" src="../../media/important/UR.png" alt=""> -->
                    </a>
                </li>
                <li class="row-con-itm">
                    <form action="{% url 'search' %}" class="search-form">
                        {% csrf_token %}
                        <input type="text" name="search" class="search-inp" placeholder="Search" autocomplete="off">
                    </form>
                </li>
                {% if user.is_authenticated %}
                <div class="inbox">
                    <div class="inboxDrBtn">
                        Inbox
                    </div>
                    <div id="inboxDropdown">
                        {% include 'temps/notifications.html' %}
                    </div>
                </div>
                <li class="row-con-itm">
                    <a href="{% url 'user_profile' request.user.username %}">
                        {% if request.user.profile.avatar.url != null %}
                        <img src="{{request.user.profile.avatar.url}}" alt="" class="pp">
                        {% else %}
                        <div class="pp" style="background: linear-gradient({{request.user.profile.avatar_default}});">
                            <div class="grcn">
                                {{request.user.profile.name|slice:"0:1"}}
                            </div>
                        </div>
                        {% endif %}
                    </a>
                </li>
                {% else %}
                <li class="row-con-itm">
                    <div onclick="openSigninModal()">Sign in</div>
                </li>
                {% endif %}
            </ul>
        </div>
    </nav>
    <main id="main">
        <div class="main-content">
            {% block content %}

            {% endblock %}
        </div>
    </main>
    <footer id="footer">
        <div id="footer-row">
            <div class="by">Developed by Rakmatullaev.</div>
            {% block footer %}
            {% endblock %}
        </div>
    </footer>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script type='text/javascript' src="{% static 'jquery.js' %}"></script>

    <!--  -->
    <script>
        const signin_password = document.getElementById("signin-password");
        const toggleSigninPassword = document.getElementById("toggle-signin-password");

        toggleSigninPassword.addEventListener("click", toggleClicked);
        function toggleClicked() {
            if (this.checked) {
                signin_password.type = "text";
            } else {
                signin_password.type = "password";
            }
        }
    </script>
    <script>
        // var elements = document.getElementsByClassName("postDropdown");
        // for (var i = 0; i < elements.length; i++) {
        const $dropdownMenu = $('[id=inboxDropdown]');

        const onDrMouseUp = e => {
            if (!$dropdownMenu.is(e.target)
                && $dropdownMenu.has(e.target).length === 0) {
                $dropdownMenu.removeClass('active')
            }
        }

        $('.inboxDrBtn').on('click', () => {
            $dropdownMenu.toggleClass('active').promise().done(() => {
                if ($dropdownMenu.hasClass('active')) {
                    $(document).on('drmouseup', onDrMouseUp)
                } else {
                    $(document).off('drmouseup', onDrMouseUp)
                }
            })
        })
        // }
    </script>
    <script>
        const password = document.getElementById("signup-password");
        const password2 = document.getElementById("confirm");
        const togglePassword = document.getElementById("toggle-signup-password");

        togglePassword.addEventListener("click", toggleClicked);
        function toggleClicked() {
            if (this.checked) {
                password.type = "text";
                password2.type = "text";
            } else {
                password.type = "password";
                password2.type = "password";
            }
        }
    </script>
    <script>
        const signinModal = document.getElementById("signinModal");
        const signupModal = document.getElementById("signupModal");
        function openSigninModal() {
            signinModal.classList.add('show');
            signupModal.classList.remove('show');
        }
        function closeSigninModal() {
            signinModal.classList.remove('show');
        }
        // signup
        function openSignupModal() {
            signinModal.classList.remove('show');
            signupModal.classList.add('show');
        }
        function closeSignupModal() {
            signupModal.classList.remove('show');
        }
        window.onclick = function (event) {
            if (event.target == signinModal) {
                signinModal.classList.remove('show');
            }
            else if (event.target == signupModal) {
                signupModal.classList.remove('show');
            }
        }
    </script>
    <script>
        $(document).ready(function () {
            $('#toast-position').toggleClass('active')

            setTimeout(function () {
                $('#toast-position').toggleClass('timeout')
                $('#toast-position').fadeOut('fast');
            }, 3000);
        })
    </script>
    {% block scripts %}
    {% endblock %}
</body>

</html>