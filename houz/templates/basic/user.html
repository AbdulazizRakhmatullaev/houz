{% extends 'base.html' %}
{% load i18n %}

{% block title %} Home {% endblock %}

{% block content %}
<div class="p-col">
    <div class="left-pp-col">
        <div class="p-main">
            <div class="p-first">
                {% if user.profile.avatar.url != null %}
                <img src="{{user.profile.avatar.url}}" alt="" class="uspp">
                {% else %}
                <div class="uspp" style="background: linear-gradient({{user.profile.avatar_default}});">
                <div class="usgrcn">
                    {{user.profile.name|slice:"0:1"}}
                </div>
                </div>
                {% endif %}
                <div class="p-names-col">
                    <div class="nminfo">
                        <div class="p-name">{{user.profile.name}}</div>
                        <div class="p-usname">@{{user.username}}</div>
                    </div>
                    
                    <div class="abfl">
                        {% if request.user.is_authenticated %}
                        {% if user.profile.badge %}
                        <div class="p-badge" title="User badge">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                viewBox="0 0 28 28">
                                <path fill-rule="evenodd"
                                    d="M14 14.5a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11Zm0-2a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7ZM19 27a6 6 0 1 0 0-12 6 6 0 0 0 0 12Zm2.936-7.49-1.673-.164-.736-1.738c-.23-.544-.822-.544-1.052 0l-.737 1.738-1.673.165c-.584.057-.762.637-.31 1.02l1.309 1.114-.486 1.814c-.16.596.337.955.832.598l1.59-1.15 1.592 1.15c.496.359.992-.002.832-.598l-.486-1.814 1.31-1.113c.449-.383.27-.964-.312-1.021Z"
                                    clip-rule="evenodd" />
                                <path
                                    d="M11.982 16.569a1 1 0 0 1-.795 1.17c-2.272.433-3.272 1.361-3.729 2.05a2.902 2.902 0 0 0-.408.917 2.016 2.016 0 0 0-.05.306v.488a.5.5 0 0 0 .5.5h3a1 1 0 1 1 0 2h-3A2.5 2.5 0 0 1 5 21.5V21h1c-1 0-1-.002-1-.002v-.032a2.115 2.115 0 0 1 .015-.215c.014-.13.04-.306.091-.515a4.9 4.9 0 0 1 .686-1.553c.793-1.195 2.293-2.389 5.02-2.909a1 1 0 0 1 1.17.795Z" />
                            </svg>
                            {{user.profile.badge}}
                        </div>
                        {% endif %}
                        {% endif %}
                        <div class="jd_dt prinf">
                            <div class="pplicn p-txt">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28"><path fill-rule="evenodd" d="M10 2a1 1 0 0 0-2 0v1.16a5.856 5.856 0 0 0-1.93.641A5.466 5.466 0 0 0 3.8 6.07C3.216 7.165 3 8.244 3 10.692v6.616c0 2.448.216 3.527.801 4.622A5.465 5.465 0 0 0 6.07 24.2c1.096.585 2.175.801 4.623.801h6.616c2.448 0 3.527-.216 4.622-.801a5.465 5.465 0 0 0 2.269-2.27c.585-1.095.801-2.174.801-4.622v-6.616c0-2.448-.216-3.527-.801-4.623a5.465 5.465 0 0 0-2.269-2.268A5.855 5.855 0 0 0 20 3.16V2a1 1 0 1 0-2 0v1.007A34.168 34.168 0 0 0 17.308 3h-6.616c-.244 0-.474.002-.692.007V2Zm8 4v-.993A31.379 31.379 0 0 0 17.308 5h-6.616c-.249 0-.479.002-.692.007V6a1 1 0 1 1-2 0v-.805a3.659 3.659 0 0 0-.987.37 3.466 3.466 0 0 0-1.448 1.448C5.212 7.673 5 8.357 5 10.692v6.616c0 2.335.212 3.019.565 3.68a3.466 3.466 0 0 0 1.448 1.447c.66.353 1.344.565 3.679.565h6.616c2.335 0 3.019-.212 3.68-.565a3.467 3.467 0 0 0 1.447-1.448c.353-.66.565-1.344.565-3.679v-6.616c0-2.335-.212-3.019-.565-3.68a3.466 3.466 0 0 0-1.448-1.447 3.657 3.657 0 0 0-.987-.37V6a1 1 0 1 1-2 0Zm1.176 6.237a1 1 0 0 0-1.352-1.474l-5.294 4.853-1.823-1.823a1 1 0 0 0-1.414 1.414l2.5 2.5a1 1 0 0 0 1.383.03l6-5.5Z" clip-rule="evenodd"/></svg>
                            </div>
                            <div class="rcon p-txt">
                                Joined {{user.profile.created_at|date:"F Y"}}
                            </div>
                        </div>
                    </div>
                    
                    <div class="abfl">
                        <div class="p-txt"">
                            <b>{{user.profile.my_rating}}</b> Profile rating
                        </div>
                        <div class="p-txt">
                            <b>{{rating_count}}</b> Reviews
                        </div>
                    </div>
                </div>
            </div>
            
            {% if user.profile.bio %}
            <div class="hr"></div>
            <div class="lbld">
                <div class="lbl0" style="padding-top: 0;">About {% if is_own_profile %} Me {% else %} {{user.profile.first_name}} {% endif %}</div>
                <div class="aboutcol">
                    <div class="bio">
                        {{user.profile.bio}}
                    </div>
                    <div class="country prinf">
                        <div class="licn">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12.002 3.8a3.849 3.849 0 0 0-3.85 3.847c0 2.457 1.457 5.1 2.788 6.977.551.778 1.6.776 2.149-.004 1.32-1.875 2.763-4.517 2.763-6.973a3.849 3.849 0 0 0-3.85-3.847Zm-5.65 3.847c0-3.12 2.53-5.647 5.65-5.647 3.12 0 5.65 2.528 5.65 5.647 0 3.048-1.737 6.084-3.091 8.009-1.265 1.797-3.819 1.801-5.09.01-1.364-1.926-3.119-4.966-3.119-8.02Z M13.752 7.75a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0Z M17.211 14.32a.9.9 0 0 1 1.268-.109c.833.7 1.526 1.589 1.526 2.789 0 1.753-1.064 3.038-2.539 3.836-1.456.789-3.394 1.166-5.466 1.166-2.09 0-4.027-.432-5.475-1.244C5.077 19.945 4 18.669 4 17c0-1.189.712-2.096 1.514-2.783a.9.9 0 1 1 1.172 1.366c-.652.559-.886 1.01-.886 1.417 0 .789.492 1.563 1.605 2.188 1.112.623 2.725 1.014 4.595 1.014 1.888 0 3.502-.349 4.609-.948 1.087-.59 1.596-1.356 1.596-2.254 0-.42-.22-.853-.884-1.411a.9.9 0 0 1-.11-1.268Z" clip-rule="evenodd"/></svg>
                        </div>
                        <div class="rcon">
                            From {{user.profile.country}}
                        </div>
                    </div>
                    <div class="lngs prinf">
                        <div class="licn">
                            <svg id="lngbtn" class="row-svg" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                <!-- SVG content here -->
                                <g id="Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <g id="globe_24">
                                        <polygon id="Bounds" points="0 0 24 0 24 24 0 24"></polygon>
                                        <path d="M14.3139017,9.5 L9.76986204,9.5 C9.59398792,10.4564417 9.5,11.4612378 9.5,12.5 C9.5,13.1826997 9.54059749,13.8507278 9.61835697,14.5 L14.3139017,14.5 C14.4356838,13.6953397 14.5,12.8592914 14.5,12 C14.5,11.1407086 14.4356838,10.3046603 14.3139017,9.5 Z M15.828868,9.5 C15.941236,10.3101606 16,11.1458159 16,12 C16,12.8541841 15.941236,13.6898394 15.828868,14.5 L20.1264018,14.5 C20.3692775,13.709578 20.5,12.8700549 20.5,12 C20.5,11.1299451 20.3692775,10.290422 20.1264018,9.5 L15.828868,9.5 Z M11.9787868,20.4999741 C12.8743955,19.2484901 13.5784582,17.7173329 14.0123348,16 L9.8701737,16 C10.2381057,17.6910752 10.8647268,19.2171111 11.679348,20.4940636 C11.7787343,20.4977496 11.8785567,20.4997292 11.9787868,20.4999741 Z M13.8941081,20.2881873 C16.323929,19.7352123 18.3578489,18.1411601 19.5018987,16 L15.5537509,16 C15.1931202,17.5715502 14.6255781,19.0202886 13.8941081,20.2881873 Z M13.8941081,3.71181266 C14.6255781,4.97971137 15.1931202,6.42844979 15.5537509,8 L19.5018987,8 C18.3578489,5.85883989 16.323929,4.26478773 13.8941081,3.71181266 Z M14.0123348,8 C13.611081,6.41179201 12.9787439,4.98281555 12.1775251,3.78702389 C11.297434,4.95651582 10.5894785,6.38836004 10.1230965,8 L14.0123348,8 Z M8.24779603,9.5 L3.87359822,9.5 C3.63072245,10.290422 3.5,11.1299451 3.5,12 C3.5,12.8700549 3.63072245,13.709578 3.87359822,14.5 L8.10898255,14.5 C8.0371936,13.8473992 8,13.1795634 8,12.5 C8,11.4689181 8.08562382,10.4648341 8.24779603,9.5 Z M9.79014964,20.2099028 C9.13825906,18.9471579 8.64213019,17.5269419 8.33935209,16 L4.49810129,16 C5.59223541,18.0477398 7.50028235,19.5950716 9.79014964,20.2099028 Z M10.4546882,3.64012814 C7.87125626,4.11462111 5.69648108,5.75715794 4.49810129,8 L8.56901903,8 C8.99233147,6.38315756 9.63732117,4.90768197 10.4546882,3.64012814 Z M12,22 C6.4771525,22 2,17.5228475 2,12 C2,6.4771525 6.4771525,2 12,2 C17.5228475,2 22,6.4771525 22,12 C22,17.5228475 17.5228475,22 12,22 Z" id="Mask" fill="currentColor" fill-rule="nonzero"></path>
                                    </g>
                                </g>
                            </svg>
                        </div>
                        <div class="rcon">
                            Speaks {{user.profile.languages}}
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
            
            {% if user == request.user %}
            <div class="p-last">
                <a href="{% url 'profile_edit' %}" class="btn-white">Edit</a>
                <a href="{% url 'signout' %}" class="btn-white" onclick="return confirmReq()">Sign out</a>
            </div>
            {% endif %}
        </div>
    </div>
    <div class="right-pp-col">
        <div class="user-roomscol">
            <div class="lbld">
                <div class="lbl0">{% if is_own_profile %} My {% else %} {{user.profile.first_name}}'s {% endif %} listings</div>
                <div class="p-rooms">
                    {% for room in rooms %}
                    <div class="p-room">
                        <div class="public" style="{% if room.public %}background: #00f200;{% else %}background: red;{% endif %}" title="{% if room.public %}It's public{% else %}It's private{% endif %}"></div>
                        {% if is_own_profile %}
                        <div class="roomtools">
                            <button class="objdel" onclick="location.href='@{{user.username}}/rooms/{{room.id}}/edit';">
                                <svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg"
                                    xmlns:xlink="http://www.w3.org/1999/xlink">
                                    <path
                                        d="M14.1882588,6.27301517 L17.7278487,9.81260506 L9.10415743,18.4354891 C8.33089999,19.2086803 7.3795132,19.7800394 6.33365949,20.0993225 L3.43116121,20.9854108 C3.2548849,21.0392252 3.06835948,20.9399503 3.01454502,20.763674 C2.99515549,20.700161 2.99515549,20.6323075 3.01454502,20.5687946 L3.90054461,17.6665868 C4.21988422,16.620548 4.79138805,15.6690125 5.5647823,14.8956845 L14.1882588,6.27301517 Z M15.2489686,5.21240463 L17.017722,3.44381677 C17.6035158,2.85807317 18.5532282,2.85809351 19.1389969,3.4438622 L20.5573573,4.86204088 C21.1431438,5.44782732 21.1431438,6.39757479 20.5573573,6.98336123 C20.5573422,6.98337637 20.5573271,6.98339152 20.5573119,6.98340666 L18.7885585,8.75199452 L15.2489686,5.21240463 Z"
                                        id="Mask"></path>
                                </svg>
                            </button>
                            <form action="{% url 'room_delete' room.id %}" method="POST">
                                {% csrf_token %}
                                <button class="objdel" type="submit" onclick="return confirmReq()">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M14.556 8.102a.9.9 0 0 1 .842.954l-.5 8a.9.9 0 0 1-1.796-.112l.5-8a.9.9 0 0 1 .954-.842Zm-5.112 0a.9.9 0 0 0-.842.954l.5 8a.9.9 0 1 0 1.796-.112l-.5-8a.9.9 0 0 0-.954-.842Z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M3 4.1a.9.9 0 1 0 0 1.8h1.18l1.155 12.316c.045.484.084.898.143 1.237.062.359.157.704.351 1.03a2.9 2.9 0 0 0 1.249 1.137c.342.162.695.225 1.057.253.344.027.76.027 1.246.027h5.238c.486 0 .902 0 1.246-.027.362-.028.715-.09 1.057-.253a2.9 2.9 0 0 0 1.249-1.137c.194-.326.289-.671.35-1.03.06-.34.099-.753.144-1.237L19.82 5.9H21a.9.9 0 1 0 0-1.8h-5.204a3.901 3.901 0 0 0-7.592 0H3Zm4.124 13.915c.05.526.082.869.128 1.13.043.252.087.356.124.417a1.1 1.1 0 0 0 .474.432c.064.03.172.065.426.085.265.02.61.021 1.138.021h5.172c.528 0 .873 0 1.138-.021.254-.02.362-.055.426-.085a1.1 1.1 0 0 0 .474-.432c.037-.06.08-.166.124-.416.046-.262.079-.605.128-1.131L18.012 5.9H5.988l1.136 12.115ZM12 2.9a2.1 2.1 0 0 0-1.898 1.2h3.796A2.1 2.1 0 0 0 12 2.9Z" clip-rule="evenodd"/></svg>
                                </button>
                            </form>
                        </div>
                        {% endif %}
                        
                        <a href="{% url 'room_detail_url' room.id %}">
                            <div class="room-img">
                                {% if room.first_photo %}
                                <img src="{{ room.first_photo }}" alt="{% trans 'Room Image' %}">
                                {% else %}
                                {% trans 'no image' %}
                                {% endif %}
                            </div>
                            <div class="room-info">
                                <div class="room-fl">
                                    <div class="ci-cy">
                                        {% blocktrans with city=room.get_city_display %}{{ city }}, Uzbekistan{% endblocktrans %}
                                    </div>
                                    <div class="rating">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" aria-hidden="true" role="presentation"
                                            focusable="false" style="display: block; height: 12px; width: 12px; fill: currentcolor;">
                                            <path fill-rule="evenodd"
                                                d="m15.1 1.58-4.13 8.88-9.86 1.27a1 1 0 0 0-.54 1.74l7.3 6.57-1.97 9.85a1 1 0 0 0 1.48 1.06l8.62-5 8.63 5a1 1 0 0 0 1.48-1.06l-1.97-9.85 7.3-6.57a1 1 0 0 0-.55-1.73l-9.86-1.28-4.12-8.88a1 1 0 0 0-1.82 0z">
                                            </path>
                                        </svg>
                                        {{ room.average_rating }}
                                    </div>
                                </div>
                                <div class="in-out">{{ room.av_dates }}</div>
                                <div class="r-price">
                                    {{currency}}{{room.converted_price}}/{% trans "night" %}
                                </div>
                            </div>
                        </a>
                    </div>
                    {% empty %}
                    <div class="infotxt coll0">No rooms were shared yet...</div>
                    {% endfor %}
                </div>
            </div>
            <div class="lbld">
                <div class="lbl0">{% if is_own_profile %} My {% else %} {{user.profile.first_name}}'s {% endif %} reviews</div>
                <div id="room-reviews-content">
                    {% for review in reviews %}
                    <div class="revren">
                        <a href="{% url 'room_detail_url' review.room.id %}" class="ren">
                            <div class="rente">{{review.room.title}}</div>
                            <img class="renimg" src="{{review.room.first_photo}}" alt="">
                        </a>
                        <div class="hr"></div>
                        <div class="rev">
                            <div class="revleft">
                                <a href="{% url 'user_profile' review.user.username %}">
                                    {% if review.user.profile.avatar.url != null %}
                                    <img src="{{review.user.profile.avatar.url}}" alt="" class="pp">
                                    {% else %}
                                    <div class="pp"
                                        style="background: linear-gradient({{review.user.profile.avatar_default}});">
                                        <div class="grcn">
                                            {{review.user.profile.name|slice:"0:1"}}
                                        </div>
                                    </div>
                                    {% endif %}
                                </a>
                            </div>
                            <div class="n-d">
                                <div class="n-stayed">
                                    <a href="{% url 'user_profile' review.user.username %}"
                                        class="reviewer-name">{{review.user.profile.name}}</a>
                                    <div class="spr">•</div>
                                    <div class="review-date">{{review.get_date}}</div>
                                </div>
                                <!--  -->
                                <div class="r-stars">
                                    {{review.user_ratings|safe}}
                                </div>
                                <div class="review-text">{{review.review_text}}</div>
                            </div>
                        </div>
                    </div>
                    {% empty %}
                    <div class="infotxt coll0">No reviews yet...</div>
                    {% endfor %}
                </div>
            </div>
            <div class="lbld">
                <div class="lbl0">{% if is_own_profile %} My {% else %} {{user.profile.first_name}}'s {% endif %} comments</div>
                <div id="room-reviews-content">
                    {% for comment in comments %}
                    <div class="review">
                        <div class="revleft">
                            <a href="{% url 'user_profile' comment.author.username %}">
                                {% if comment.author.profile.avatar.url != null %}
                                <img src="{{comment.author.profile.avatar.url}}" alt="" class="pp">
                                {% else %}
                                <div class="pp"
                                    style="background: linear-gradient({{comment.author.profile.avatar_default}});">
                                    <div class="grcn">
                                        {{comment.author.profile.name|slice:"0:1"}}
                                    </div>
                                </div>
                                {% endif %}
                            </a>
                        </div>
                        <div class="n-d">
                            <div class="n-stayed">
                                <a href="{% url 'user_profile' comment.author.username %}"
                                    class="reviewer-name">{{comment.author.profile.name}}</a>
                                <div class="spr">•</div>
                                <div class="review-date">{{comment.get_date}}</div>
                            </div>
                            <!--  -->
                            <div class="review-text">{{comment.text}}</div>
                        </div>
                    </div>
                    {% empty %}
                    <div class="infotxt coll0">No comments yet...</div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block footer %}
{% endblock %}
